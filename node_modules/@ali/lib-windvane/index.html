<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8" />
<title>lib-windvane</title>
<meta name="flexible" content="initial-dpr=1" />
<link rel="stylesheet" href="//g.alicdn.com/mtb/lib-bootstrap/3.0.3/css/bootstrap.min.css" />
<link rel="stylesheet" href="//g.alicdn.com/mtb/lib-3rd/highlight/monokai_sublime.min.css" />
<script src="//g.alicdn.com/mtb/lib-flexible/0.3.2/??flexible.debug.js,flexible_css.js"></script>
<script src="//g.alicdn.com/mtb/lib-3rd/??jquery/jquery.min.js,highlight/highlight.min.js"></script>
<script src="//g.alicdn.com/mtb/lib-bootstrap/3.0.3/js/bootstrap.min.js"></script>
<style>
    .container {
        margin-bottom: 10px;
    }
</style>
</head>
<body>
<script src="//g.alicdn.com/mtb/lib-promise/3.0.0/polyfillB.js"></script>
<script src="build/windvane.debug.js"></script>
<section class="jumbotron">
    <div class="container">
        <h1 class="center">lib-windvane</h1>
    </div>
</section>
<div class="container">
    <div class="row">
        <div class="col-sm-12">
              <div class="form-group">
                <label for="api">API名称</label>
                <input type="text" class="form-control" id="api" value="MtopWVPlugin.send" placeholder="输入API名称">
              </div>
              <div class="form-group">
                <label for="param">数据</label>
                <input type="text" class="form-control" id="param" value='{"api":"mtop.user.getUserSimple", "v": "1.0", "ecode": "1"}' placeholder="传递的数据">
              </div>
              <button class="btn btn-primary" id="submit">调用</button>
        </div>
    </div>
</div>
<div class="container">
    <div class="row">
        <div class="col-sm-12"><pre><code class="json" id="result">
        </code></pre></div>
    </div>
</div>
<script type="text/javascript">
    $(function() {
        var api = localStorage.getItem('lib-windvane-demo-api');
        if (api && !$('#api').val()) {
            $('#api').val(api);
        }

        var param = localStorage.getItem('lib-windvane-demo-param');
        if (param && !$('#param').val()) {
            $('#param').val(param);
        }
    });

    $('#submit').on('click', function(e) {

        var api = $('#api').val();
        var param = $('#param').val();

        if (!api || !param ) return;

        localStorage.setItem('lib-mtop-demo-api', api);
        localStorage.setItem('lib-mtop-demo-data', param);

        function handler(ret) {
            if (window['console']) {
                console && console.log(ret);
            }
            $('#result').html(JSON.stringify(ret, null, '  '));
            hljs.highlightBlock($('#result')[0]);
        }

        api = api.split('.');

        lib.windvane.call(api[0], api[1], param, handler, handler);
    });
</script>
</body>
</html>

