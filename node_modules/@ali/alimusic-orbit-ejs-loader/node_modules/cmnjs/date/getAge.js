var parse = require('./parse');

module.exports = function dateGetAge(date, pastDate) {

  // date, pastDate - values that pass parse function

  //getAge('2012/02/28', '2008/02/29') -> 3

  var tempDate;
  var age;
  var m;

  date = parse(date);
  pastDate = parse(pastDate);

  if (date && !pastDate && arguments.length === 1) {

    //one date passed
    pastDate = date;
    date = new Date();

  }

  if (!date || !pastDate) {

    //no dates passed or no valid dates
    return undefined;

  }

  if (pastDate > date) {

    // ;)
    tempDate = pastDate;
    pastDate = date;
    date = tempDate;

  }

  age = date.getFullYear() - pastDate.getFullYear();
  m = date.getMonth() - pastDate.getMonth();

  if (m < 0 || (m === 0 && date.getDate() < pastDate.getDate())) {
    age--;
  }

  return age;

};
