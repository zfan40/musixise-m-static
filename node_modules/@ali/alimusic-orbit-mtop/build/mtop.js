!function(e,t){function n(){var e={},t=new l(function(t,n){e.resolve=t,e.reject=n});return e.promise=t,e}function r(e,t){for(var n in t)void 0===e[n]&&(e[n]=t[n]);return e}function o(e,t){for(var n in t)e[n]=t[n];return e}function i(e){var t=document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]||document.firstElementChild||document;t.appendChild(e)}function a(e){var t=[];for(var n in e)e[n]&&t.push(n+"="+encodeURIComponent(e[n]));return t.join("&")}function s(e){function t(e,t){return e<<t|e>>>32-t}function n(e,t){var n,r,o,i,a;return o=2147483648&e,i=2147483648&t,n=1073741824&e,r=1073741824&t,a=(1073741823&e)+(1073741823&t),n&r?2147483648^a^o^i:n|r?1073741824&a?3221225472^a^o^i:1073741824^a^o^i:a^o^i}function r(e,t,n){return e&t|~e&n}function o(e,t,n){return e&n|t&~n}function i(e,t,n){return e^t^n}function a(e,t,n){return t^(e|~n)}function s(e,o,i,a,s,p,u){return e=n(e,n(n(r(o,i,a),s),u)),n(t(e,p),o)}function p(e,r,i,a,s,p,u){return e=n(e,n(n(o(r,i,a),s),u)),n(t(e,p),r)}function u(e,r,o,a,s,p,u){return e=n(e,n(n(i(r,o,a),s),u)),n(t(e,p),r)}function c(e,r,o,i,s,p,u){return e=n(e,n(n(a(r,o,i),s),u)),n(t(e,p),r)}function f(e){for(var t,n=e.length,r=n+8,o=(r-r%64)/64,i=16*(o+1),a=new Array(i-1),s=0,p=0;n>p;)t=(p-p%4)/4,s=p%4*8,a[t]=a[t]|e.charCodeAt(p)<<s,p++;return t=(p-p%4)/4,s=p%4*8,a[t]=a[t]|128<<s,a[i-2]=n<<3,a[i-1]=n>>>29,a}function d(e){var t,n,r="",o="";for(n=0;3>=n;n++)t=e>>>8*n&255,o="0"+t.toString(16),r+=o.substr(o.length-2,2);return r}function l(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var r=e.charCodeAt(n);128>r?t+=String.fromCharCode(r):r>127&&2048>r?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(63&r|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(63&r|128))}return t}var m,h,v,_,y,R,g,S,T,w=[],q=7,O=12,E=17,A=22,C=5,N=9,k=14,b=20,J=4,H=11,j=16,V=23,x=6,P=10,I=15,D=21;for(e=l(e),w=f(e),R=1732584193,g=4023233417,S=2562383102,T=271733878,m=0;m<w.length;m+=16)h=R,v=g,_=S,y=T,R=s(R,g,S,T,w[m+0],q,3614090360),T=s(T,R,g,S,w[m+1],O,3905402710),S=s(S,T,R,g,w[m+2],E,606105819),g=s(g,S,T,R,w[m+3],A,3250441966),R=s(R,g,S,T,w[m+4],q,4118548399),T=s(T,R,g,S,w[m+5],O,1200080426),S=s(S,T,R,g,w[m+6],E,2821735955),g=s(g,S,T,R,w[m+7],A,4249261313),R=s(R,g,S,T,w[m+8],q,1770035416),T=s(T,R,g,S,w[m+9],O,2336552879),S=s(S,T,R,g,w[m+10],E,4294925233),g=s(g,S,T,R,w[m+11],A,2304563134),R=s(R,g,S,T,w[m+12],q,1804603682),T=s(T,R,g,S,w[m+13],O,4254626195),S=s(S,T,R,g,w[m+14],E,2792965006),g=s(g,S,T,R,w[m+15],A,1236535329),R=p(R,g,S,T,w[m+1],C,4129170786),T=p(T,R,g,S,w[m+6],N,3225465664),S=p(S,T,R,g,w[m+11],k,643717713),g=p(g,S,T,R,w[m+0],b,3921069994),R=p(R,g,S,T,w[m+5],C,3593408605),T=p(T,R,g,S,w[m+10],N,38016083),S=p(S,T,R,g,w[m+15],k,3634488961),g=p(g,S,T,R,w[m+4],b,3889429448),R=p(R,g,S,T,w[m+9],C,568446438),T=p(T,R,g,S,w[m+14],N,3275163606),S=p(S,T,R,g,w[m+3],k,4107603335),g=p(g,S,T,R,w[m+8],b,1163531501),R=p(R,g,S,T,w[m+13],C,2850285829),T=p(T,R,g,S,w[m+2],N,4243563512),S=p(S,T,R,g,w[m+7],k,1735328473),g=p(g,S,T,R,w[m+12],b,2368359562),R=u(R,g,S,T,w[m+5],J,4294588738),T=u(T,R,g,S,w[m+8],H,2272392833),S=u(S,T,R,g,w[m+11],j,1839030562),g=u(g,S,T,R,w[m+14],V,4259657740),R=u(R,g,S,T,w[m+1],J,2763975236),T=u(T,R,g,S,w[m+4],H,1272893353),S=u(S,T,R,g,w[m+7],j,4139469664),g=u(g,S,T,R,w[m+10],V,3200236656),R=u(R,g,S,T,w[m+13],J,681279174),T=u(T,R,g,S,w[m+0],H,3936430074),S=u(S,T,R,g,w[m+3],j,3572445317),g=u(g,S,T,R,w[m+6],V,76029189),R=u(R,g,S,T,w[m+9],J,3654602809),T=u(T,R,g,S,w[m+12],H,3873151461),S=u(S,T,R,g,w[m+15],j,530742520),g=u(g,S,T,R,w[m+2],V,3299628645),R=c(R,g,S,T,w[m+0],x,4096336452),T=c(T,R,g,S,w[m+7],P,1126891415),S=c(S,T,R,g,w[m+14],I,2878612391),g=c(g,S,T,R,w[m+5],D,4237533241),R=c(R,g,S,T,w[m+12],x,1700485571),T=c(T,R,g,S,w[m+3],P,2399980690),S=c(S,T,R,g,w[m+10],I,4293915773),g=c(g,S,T,R,w[m+1],D,2240044497),R=c(R,g,S,T,w[m+8],x,1873313359),T=c(T,R,g,S,w[m+15],P,4264355552),S=c(S,T,R,g,w[m+6],I,2734768916),g=c(g,S,T,R,w[m+13],D,1309151649),R=c(R,g,S,T,w[m+4],x,4149444226),T=c(T,R,g,S,w[m+11],P,3174756917),S=c(S,T,R,g,w[m+2],I,718787259),g=c(g,S,T,R,w[m+9],D,3951481745),R=n(R,h),g=n(g,v),S=n(S,_),T=n(T,y);var U=d(R)+d(g)+d(S)+d(T);return U.toLowerCase()}function p(e){var t=new RegExp("(?:^|;\\s*)"+e+"\\=([^;]+)(?:;\\s*|$)").exec(document.cookie);return t?t[1]:void 0}function u(e,t,n){var r=new Date;r.setTime(r.getTime()-864e5);var o="/";doc.cookie=e+"=;path="+o+";domain=."+t+";expires="+r.toGMTString(),doc.cookie=e+"=;path="+o+";domain=."+n+"."+t+";expires="+r.toGMTString()}function c(){var t=e.location.hostname,n=["taobao.net","taobao.com","tmall.com","tmall.hk","etao.com","dongting.com"],r=new RegExp("([^.]*?)\\.?((?:"+n.join(")|(?:").replace(/\./g,"\\.")+"))","i"),o=t.match(r)||[],i=o[2]||"taobao.com",a=o[1]||"m";"taobao.net"!==i||"x"!==a&&"waptest"!==a&&"daily"!==a?"taobao.net"===i&&"demo"===a?a="demo":"waptest"!==a&&"wapa"!==a&&"m"!==a&&(a="m"):a="waptest";var s="etao.com"===i?"apie":"api";y.mainDomain=i,y.subDomain=a,y.prefix=s}function f(){var t=e.navigator.userAgent,n=t.match(/WindVane[\/\s]([\d\.\_]+)/);n&&(y.WindVaneVersion=n[1]);var r=t.match(/AliApp\(([^\/]+)\/([\d\.\_]+)\)/i);r&&(y.AliAppName=r[1],y.AliAppVersion=r[2])}function d(e){this.id=++S,this.params=r(e||{},{v:"*",data:{},type:"get",dataType:"jsonp"}),this.params.type=this.params.type.toLowerCase(),"object"==typeof this.params.data&&(this.params.data=JSON.stringify(this.params.data)),this.middlewares=R.slice(0)}var l=e.Promise;if(!l){var m="\u5f53\u524d\u6d4f\u89c8\u5668\u4e0d\u652f\u6301Promise\uff0c\u8bf7\u53c2\u8003\u6587\u6863\uff08http://gitlab.alibaba-inc.com/mtb/lib-es6polyfill/tree/master\uff09\u4e2d\u7684\u89e3\u51b3\u65b9\u6848";return t.mtop={ERROR:m},void console.error(m)}var h=l.resolve(),v=e.localStorage;if(v)try{v.setItem("@private","false")}catch(_){v=!1}var y={useAlipayJSBridge:!1},R=[],g={ERROR:-1,SUCCESS:0,TOKEN_EXPIRED:1,SESSION_EXPIRED:2};c(),f();var S=0;d.prototype.use=function(e){if(!e)throw new Error("middleware is undefined");return this.middlewares.push(e),this},d.prototype.__processRequestMethod=function(e){var t=this.params,n=this.options;"get"===t.type&&"jsonp"===t.dataType?n.getJSONP=!0:"get"===t.type&&"json"===t.dataType?n.getJSON=!0:"post"===t.type&&(n.postJSON=!0),e()},d.prototype.__processRequestType=function(e){var t=this.options;if(y.H5Request===!0&&(t.H5Request=!0),y.WindVaneRequest===!0&&(t.WindVaneRequest=!0),t.H5Request===!1&&t.WindVaneRequest===!0){if(!lib.windvane||parseFloat(t.WindVaneVersion)<5.4)throw new Error("WINDVANE_NOT_FOUND::\u7f3a\u5c11WindVane\u73af\u5883")}else t.H5Request===!0?t.WindVaneRequest=!1:"undefined"==typeof t.WindVaneRequest&&"undefined"==typeof t.H5Request&&(lib.windvane&&parseFloat(t.WindVaneVersion)>=5.4&&/AliApp\(AENT|zyule/i.test(window.navigator.userAgent)?t.WindVaneRequest=!0:t.H5Request=!0);e().then(function(){var e=t.retJson.ret;e instanceof Array&&(e=e.join(","))})};var T="_m_h5_tk",w="_m_h5_tk_enc";d.prototype.__getTokenFromAlipay=function(){var t=n(),r=this.options,o=(e.navigator.userAgent,!!location.protocol.match(/^https?\:$/)),i="AP"===r.AliAppName&&parseFloat(r.AliAppVersion)>=8.2;return r.useAlipayJSBridge===!0&&!o&&i&&e.AlipayJSBridge&&e.AlipayJSBridge.call?e.AlipayJSBridge.call("getMtopToken",function(e){e&&e.token&&(r.token=e.token),t.resolve()},function(){t.resolve()}):t.resolve(),t.promise},d.prototype.__getTokenFromCookie=function(){var e=this.options;return e.token=e.token||p(T),e.token&&(e.token=e.token.split("_")[0]),l.resolve()},d.prototype.__processToken=function(e){var t=this,n=this.options;this.params;return n.token&&delete n.token,n.WindVaneRequest!==!0?h.then(function(){return t.__getTokenFromAlipay()}).then(function(){return t.__getTokenFromCookie()}).then(e).then(function(){var e=n.retJson,r=e.ret;if(r instanceof Array&&(r=r.join(",")),r.indexOf("TOKEN_EMPTY")>-1||r.indexOf("TOKEN_EXOIRED")>-1){if(n.maxRetryTimes=n.maxRetryTimes||5,n.failTimes=n.failTimes||0,n.H5Request&&++n.failTimes<n.maxRetryTimes)return t.__sequence([t.__processToken,t.__processRequestUrl,t.__processUnitPrefix,t.middlewares,t.__processRequest]);maxRetryTimes>0&&(u(T,n.mainDomain,n.subDomain),u(w,n.mainDomain,n.subDomain)),e.retType=g.TOKEN_EXPIRED}}):void e()},d.prototype.__fillMtopHeader=function(e){var t=this.params,n=this.options;if(n.H5Request===!0){t=t?t:{};var i={requestStr:{header:{platformId:"h5",callId:Date.now(),appVersion:1e6,resolution:window.innerWidth+"*"+window.innerHeight}}},a={};"string"==typeof t.data?a=JSON.parse(t.data):"object"==typeof t.data&&(a=t.data),r(i.requestStr,a),o(i.requestStr.header,a.header?a.header:{}),i.requestStr=JSON.stringify(i.requestStr),t.data=JSON.stringify(i)}e()},d.prototype.__processRequestUrl=function(e){var t=this.params,n=this.options;if(n.H5Request===!0){var r="//"+(n.prefix?n.prefix+".":"")+(n.subDomain?n.subDomain+".":"")+n.mainDomain+"/h5/"+t.api.toLowerCase()+"/"+t.v.toLowerCase()+"/",o=t.appKey||("waptest"===n.subDomain?"4272":"12574478"),i=(new Date).getTime(),a=s(n.token+"&"+i+"&"+o+"&"+t.data),p={appKey:o,t:i,sign:a},u={data:t.data,ua:t.ua};Object.keys(t).forEach(function(e){"undefined"==typeof p[e]&&"undefined"==typeof u[e]&&(p[e]=t[e])}),n.getJSONP?p.type="jsonp":(n.getJSON||n.postJSON)&&(p.type="originaljson"),n.querystring=p,n.postdata=u,n.path=r}e()},d.prototype.__processUnitPrefix=function(t){var n=this.params,r=this.options;if(v&&r.H5Request===!0){var o=n.api,a=!1,s=p("_m_user_unitinfo_"),u=v.getItem("unitinfo");s&&s.split("|")[0].indexOf("center")<0&&u&&u.indexOf(o.toLowerCase())>=0&&(a=s.split("|")[1]),a&&r.path&&(r.path=r.path.replace(/^\/\//,"//"+a+".")),t().then(function(){if(v){var t=p("_m_unitapi_v_"),n=v.getItem("unitinfo");if(t){var o=n?JSON.parse(n):{};if(!n||t!==o.version){var a=!1,s="//h5."+r.subDomain+".taobao.com/js/mtop/unit/"+t+"/unitApi.js",u=document.createElement("script");u.src=s;var c=function(){a||(a=!0,u.onload=u.onerror=null,u.parentNode&&u.parentNode.removeChild(u))};u.onerror=function(){c()},e.jsonp_unitapi||(e.jsonp_unitapi=function(e){c(),v.setItem("unitinfo",JSON.stringify(e))}),i(u)}}}})}else t()};var q=0;d.prototype.__requestJSONP=function(e){function t(e){if(c&&clearTimeout(c),f.parentNode&&f.parentNode.removeChild(f),"TIMEOUT"===e)window[u]=function(){window[u]=void 0;try{delete window[u]}catch(e){}};else{window[u]=void 0;try{delete window[u]}catch(t){}}}var r=n(),o=this.params,s=this.options,p=o.timeout||2e4,u="mtopjsonp"+ ++q,c=setTimeout(function(){t("TIMEOUT"),e("TIMEOUT::\u63a5\u53e3\u8d85\u65f6")},p);s.querystring.callback=u;var f=document.createElement("script");return f.src=s.path+"?"+a(s.querystring)+"&"+a(s.postdata),f.sync=!0,f.onerror=function(){t("ABORT"),e("ABORT::\u63a5\u53e3\u5f02\u5e38\u9000\u51fa")},window[u]=function(){s.results=Array.prototype.slice.call(arguments),t(),r.resolve()},i(f),r.promise},d.prototype.__requestJSON=function(t){function r(e){c&&clearTimeout(c),"TIMEOUT"===e&&p.abort()}var o=n(),i=this.params,s=this.options,p=new e.XMLHttpRequest,u=i.timeout||2e4,c=setTimeout(function(){r("TIMEOUT"),t("TIMEOUT::\u63a5\u53e3\u8d85\u65f6")},u);p.onreadystatechange=function(){if(4==p.readyState){var e,n,i=p.status;if(i>=200&&300>i||304==i){r(),e=p.responseText,n=p.getAllResponseHeaders()||"";try{e=/^\s*$/.test(e)?{}:JSON.parse(e),e.responseHeaders=n,s.results=[e],o.resolve()}catch(a){t("PARSE_JSON_ERROR::\u89e3\u6790JSON\u5931\u8d25")}}else r("ABORT"),t("ABORT::\u63a5\u53e3\u5f02\u5e38\u9000\u51fa")}};var f,d,l=s.path+"?"+a(s.querystring);if(s.getJSON?(f="GET",l+="&"+a(s.postdata)):s.postJSON&&(f="POST",d=a(s.postdata)),p.open(f,l,!0),p.withCredentials=!0,p.setRequestHeader("Accept","application/json"),p.setRequestHeader("Content-type","application/x-www-form-urlencoded"),i.headers)for(var m in i.headers)p.setRequestHeader(m,i.headers[m]);return p.send(d),o.promise},d.prototype.__requestWindVane=function(e){function t(e){var t=e.response?e.response:{},n={};for(var r in t)"ret"===r||"retType"===r?n[r]=t[r]:e[r]=t[r];delete e.response,e.mtopRet=n,n.ret instanceof Array&&(e.ret=n.ret,e.retType=n.retType),p.results=[e],a.resolve()}var r,o,i,a=n(),s=this.params,p=this.options,u=s.data,c=s.api,f=s.v,d=p.postJSON?1:0,l="json",m="https"===location.protocol?1:0,h=s.isSec||0,v=s.sessionOption||"AutoLoginOnly";if("undefined"==typeof s.ecode)throw new Error("UNEXCEPT_PARAM_ECODE::\u7f3a\u5c11ecode\u53c2\u6570");return r=parseInt(s.ecode),i="undefined"!=typeof s.timer?parseInt(s.timer):"undefined"!=typeof s.timeout?parseInt(s.timeout):2e4,o=2*i,lib.windvane.call("alimusicTtePlugin","sendMtopRequest",{api:c,v:f,post:String(d),type:l,isHttps:String(m),ecode:String(r),isSec:String(h),param:JSON.parse(u),timer:i,sessionOption:v},t,t,o),a.promise},d.prototype.__processRequest=function(e,t){var n=this;return h.then(function(){var e=n.options;if(e.H5Request&&e.getJSONP)return n.__requestJSONP(t);if(e.H5Request&&(e.getJSON||e.postJSON))return n.__requestJSON(t);if(e.WindVaneRequest)return n.__requestWindVane(t);throw new Error("UNEXCEPT_REQUEST::\u9519\u8bef\u7684\u8bf7\u6c42\u7c7b\u578b")}).then(e).then(function(){var e=n.options,t=(n.params,e.results[0]),r=t&&t.ret||[];t.ret=r,r instanceof Array&&(r=r.join(",")),r.indexOf("SUCCESS")>-1?t.retType=g.SUCCESS:t.retType=g.ERROR,e.retJson=t})},d.prototype.__sequence=function(e){function t(e){if(e instanceof Array)e.forEach(t);else{var a,s=n(),p=n();o.push(function(){return s=n(),a=e.call(r,function(e){return s.resolve(e),p.promise},function(e){return s.reject(e),p.promise}),a&&(a=a["catch"](function(e){s.reject(e)})),s.promise}),i.push(function(e){return p.resolve(e),a})}}var r=this,o=[],i=[];e.forEach(t);for(var a,s=h;a=o.shift();)s=s.then(a);for(;a=i.pop();)s=s.then(a);return s};var O=function(e){e()},E=function(e){e()};d.prototype.request=function(e){var t=this;this.options=r(e||{},y);var n=l.resolve([O,E]).then(function(e){var n=e[0],r=e[1];return t.__sequence([n,t.__processRequestMethod,t.__processRequestType,t.__fillMtopHeader,t.__processToken,t.__processRequestUrl,t.__processUnitPrefix,t.middlewares,t.__processRequest,r])}).then(function(){var e=t.options.retJson;return e.retType!==g.SUCCESS?l.reject(e):(t.options.successCallback&&t.options.successCallback(e),l.resolve(e))})["catch"](function(e){var n;return e instanceof Error?(console.error(e.stack),n={ret:[e.message],stack:[e.stack],retJson:g.ERROR}):n="string"==typeof e?{ret:[e],retJson:g.ERROR}:void 0!==e?e:t.options.retJson,t.options.failureCallback&&t.options.failureCallback(n),l.reject(n)});return O=function(e){n.then(e)["catch"](e)},n},t.mtop=function(e){return new d(e)},t.mtop.request=function(e,t,n){var r={H5Request:e.H5Request,WindVaneRequest:e.WindVaneRequest,LoginRequest:e.LoginRequest,AntiCreep:e.AntiCreep,AntiFlood:e.AntiFlood,successCallback:t,failureCallback:n||t};return new d(e).request(r)},t.mtop.H5Request=function(e,t,n){var r={H5Request:!0,successCallback:t,failureCallback:n||t};return new d(e).request(r)},t.mtop.middlewares=R,t.mtop.config=y,t.mtop.RESPONSE_TYPE=g,t.mtop.CLASS=d}(window,window.orbit||(window.orbit={}));